基于人工智能的工业视觉检测平台通用标注技术规范
前言……………………………………………………………………………………………………………Ⅲ
1范围…………………………………………………………………………………………………………1
2规范性引用文件……………………………………………………………………………………………1
3定义…………………………………………………………………………………………………………1
4设计方法……………………………………………………………………………………………………X
附录A……………………………………………………………………………………………………………X

本标准是根据企标Q/LD A001 《企业技术标准体系》，并按照GB/T 1.1 《标准化工作导则 第1部分：标准化文件的结构和起草规则》制定。
本标准由天津市联大通讯发展有限公司提出。
本标准由天津市联大通讯发展有限公司归口。
本标准起草单位： 研发部。
本标准主要起草人：于文江。
本标准审查人员：殷亚雷、明星。
本标准批准人：



基于人工智能的工业视觉检测平台通用标注技术规范
1范围
本文件规定了基于人工智能的工业视觉2D图像检测简要流程、图像数据标注工具操作说明、数据标注保存及数据标注工具延时记录、测试方法等。
本文件适用于指导开展基于人工智能的工业视觉检测平台的规划、设计、构建和应用。
2  规范性引用文件
下列文件中的内容通过文中的规范性引用而构成本文件必不可少的条款。其中标注日期的引用文件，仅该日期对应的版本适用于本文件；不注日期的引用文件，其最新版本(包括所有的修改单)适用于本文件。
GB/T 41864-2022信息技术计算机视觉术语。
GB/T 41867-2022信息技术人工智能。
3  术语和定义
GB/T 41864-2022 和 GB/T 41867-2022界定的以下列术语和定义适用于本文件。
3.1 工业AI视觉检测系统 
该系统在工业生产领域中使用，主要应用人工智能技术，以图像视觉算法为判断方法，用于检测生产的产品质量是否符合预定的检验标准。
3.2实施方案 
目标检测模型的实施方案是由一个或多个模型构建出的用于实现智能化目标检测的组合方式及工作流程，通过细化执行流程和执行标准达到实施方案落地的准确性。
3.3名词解释说明
下列缩略语适用于本文件。
ROI: 感兴趣区域 (Region of Interest)。
OCR: 光学字符识别 (Optical Character Recognition)
3.4缩略语说明+
下列名词解释适用于本文件。
图像：图像成像编码格式支持Bayer8 、RGB、YUV 、RGB-D等一种或多种格式，图像成像文件格式应支持jpg、jpeg 、bmp 、png 、tif、tiff等一种或多种格式；
像素：像素，全称为Picture Element。它是一幅数字图像中最小的成分单元，是图像处理和计算机图形学中一个基本的度量单位，像素是由位于特定坐标位置的二进制数值或灰度值表示的。像素是指图像中最小的一个单位,一般我们将其比喻成一个点。像素由单一颜色形成，与分辨率有所不同,分辨率是指在单位面积内有多少像素,比如我门常说的1024*768是指在屏幕该面积内横向有1024个像素，纵向有768个像素；
标注框：数据标注框是指在2D图像或视频数据中，标注出目标对像的外轮廓或边界框。
路径：对应Windows系统而言是相关文件索引的磁盘存放位置。
4  设计方法
4.1  简要流程
4.1.1准备标注工具
a.准备标注工具：选择具有标注功能的软件或平台，如LabelImg、LabelMe、BAT等。这些工具提供多种标注方式，包括框选标注、语义分割、关键点标注等。
b.导入图像数据：将需要标注的图像数据导入到标注工具中。
c.确定标注标准：根据项目要求和数据集规范，确定标注的目标对像和标注标准。例如，对于人脸识别项目，需要标注眼、鼻、口等关键点；对于物体检测项目，需要标注目标物体的外轮廓或边界框。
d.进行标注：在图像或视频中选择目标对像，并使用标注工具绘制边界框。对于多个目标对像，可以使用不同的颜色或形状进行区分。
e.导出标注数据：完成标注后，将标注数据导出为指定格式的文件，如XML、PNG、TXT等。
f.质检：检查标注数据是否准确、规范，如不合格需进行修改和调整。
4.1.2操作流程  
a.准备标注工具LabelImg.exe；
b.准备数据集：在开始标注之前，需要将准备好的待标注图像数据集放在同一个文件夹中。这些数据集可以自行收集，或从公开的数据集资源中获取。确保图像质量良好，以便更准确地标注感兴趣的区域（注意收集到的图片格式要确保正确，尤其从资源网站下载的图片格式不一致，有些格式不正确的图片可能会导致打开或标注异常）。
c.打开LabelImg.exe软件进入到图1所示界面； 
d.打开需要标注的图片路径，软件中央区域会显示该路径下的第一张图片；
e.点击左侧标注格式选项，将PascalVoc切换为Yolo；
f.左侧菜单选择“Create RectBox”或在图像中点击右键选择“Create RectBox”或键盘快捷键W创建一个标注框，三种方式均可；
g.将标注框标注在对应特征物体区域，尽量贴合特征物体外轮廓或边界标注，并根据现有类型定义特征物体的标签类型，如果无类型则自定义创建类型，类型名必须为英文；
h.标注完成点击左侧菜单“Save”或键盘快捷键Crtl+S保存；
i.点击左侧菜单“Next Image”或快捷键D打开下一张图片，并重复步骤f-i完成持续的标注任务。

图1 软件按键图解

4.1.3 快捷键介绍
W、A、D 3个键位为常用键位，W为创建矩形框，A为上一张图片，D为下一张图片。其余快捷键如下：
Ctrl + u 选择要标注的文件目录；
Ctrl + r 选择标注好的标签存放的目录；
Ctrl + s 保存标注好的标签（自动保存模式下会自动保存）；
Ctrl + d 复制当前标签和矩形框；
Ctrl + Shift + d 删除当前图片；
Space 将当前图像标记为已验证；
W 开始创建矩形框；
D 切换到下一张图；
A 切换到上一张图；
Del 删除选中的标注矩形框；
Ctrl++ 放大图片；
Ctrl-- 缩小图片；
↑→↓← 移动选中的标注矩形框位置。
4.2  图像数据标注工具操作说明
图像数据标注功能要求如下：通过此标准对标注完成的文件进行质检。
4.2.1  标注工具“LabelImg.exe”
a.有笔刷、多边形、矩形、特征标签与带文本的矩形和多边形工具用于进行数据的标注；
笔刷：在图片上进行框选标注显示的工具，快捷键W；
多边形、矩形:指通过笔刷进行框选标注时，可以显示的框的形状；
特征标签：对应图片中被框选标注特征物体的命名，用于区分不同类型物体；
工具：目前常用的为“LabelImg.exe”，但后期不局限于此工具，新的标注工具会对应新的使用操作说明。
b.标注工具产生标注实例会附带特征标签，可通过特征列表对特征标签集合进行管理，并可对特征标签进行新增、编辑、删除和合并操作；
c.标注过程要对原始图像进行质检把关，包括以下几点：
数据去重：去除数据集中的重复文件；
异常值处理：检测和处理数据集中的异常文件，如损坏、模糊、花屏、马赛克、无法打开等；
数据标准化：将数据统一为一致格式，以便处理和分析。
d.选中合适的标注工具：按照标注工具说明进行标注，标注完成后进行保存，导出标注文件，打开导出的标注文件，检查信息是否正确。

4.2.2  智能标注
a.可通过智能标注功能，使标注工作得到简化，如交互式标注分割、预训练打标等；
b.预训练打标可直接生成类似人工标注完成的图片＋标注数据（XML、TXT），但仍需要通过标注工具打开文件夹，并注意对标注文件进行筛查：漏标、错标、虚标、标注框过大/过小的情况需查漏补缺。
4.2.3 标注管理
a.可对标注文件进行存储、编辑，可按条件的筛选查看，并能够导出及导入标注文件使得标注文件可以复用，对不同算法模型可应用不同的数据集进行训练；
b.可通过编辑ROI区域，使算法方案只关注图片局部信息；在串联模块下，ROI区域也可以作为前置模块输出结果的调整依据；
c.有放大缩小功能、抓手功能、隐藏/显示标注、推理结果功能以及撤销与恢复功能辅助标注。
4.2.4 标注框标准
a.边框类型和形状规则,矩形框:目标物体通常使用矩形框进行标注。边框应准确包围目标，并尽量与目标物体的边界线保持一致；多边形框:在某些情况下，目标物体的形状可能不规则，此时使用多边形框进行标注。多边形框应准确地覆盖目标物体的边界，且点的顺序应保持一致。
b.边框位置规则:
边框应紧密贴合目标: 边框应尽量紧密围绕目标物体，不应有过多的空隙；
边框应囊括完整目标:边框应包含目标物体的整个区域，不应有重叠或缺失边框，应与目标对齐；
边框的位置应与目标物体在图像中的位置保持一致，框的边缘不应超出目标物体。
c.多目标标注规则:
相邻目标的边框不应重叠:当图像中存在多个目标时，相邻目标的边框不应重叠，以保证后续处理的准确性；
相同类别目标的边框应保持一致: 对于同一类别的目标，边框的形状和位置应保持一致，以确保训练和测试时的一致性；
目标间的边框应有明确分界:对于不同类别的目标，其边框应有明确的分界，不应有过多的交叠或重叠。
d.标注框尺寸规则:
边框应包围整个目标:边框应将整个目标物体包围，不应有截断或超出目标的情况；
边框应与目标保持比例:边框的长宽比应与目标物体的长宽比相似，不应出现明显的拉伸或压缩，边框应适配目标的大小； 
对于不同大小的目标物体，边框的大小应相应调整，以保证标注的准确性。
e.标注标签规则:
标注标签应准确反映目标的类别：标注标签应与目标物体的类别相对应，并遵循预定义的类别标签规则；
多目标时标注标签的区分:对于多个不同类别的目标，标注标签应能够准确区分不同目标的类别。
4.3  数据标注保存及数据标注工具延时记录
数据标注保存及数据标注工具延时测试方法如下：
a)创建一个标注任务，包括一定数量的数据样本；
b)使用数据标注工具进行标注，并记录每个样本的标注时间；
c)在标注完成后，计算平均保存延时，即从标注完成到数据保存完成所花费的时间；
d)重复上述步骤多次，并计算平均值以获取更准确的结果
4.4 附录A
注释：以我公司现行的主流标注任务《门机防砸小目标人员检测模型》作为示例介绍。
4.4.1无遮挡标注示例

图2无遮挡正确标注样式
                                                                                                                                                                                                                                            

图3无遮挡错误标注样式
4.4.2有遮挡标注示例
目标有遮挡的情况下，遮挡超过目标面积一半的不进行标注，未超过一半的只标注目标未被遮挡的部分。

图4有遮挡正确标注样式
4.4.3其他情况示例
每一个目标物体需要单独的标注框，不允许一个标注框标注多个目标。

图5其他正确标注样式
4.4.4不进行标注示例
对于人眼无法分辨的小目标以及图像模糊、太暗、曝光过度的图片不需要标注。

图6不进行标注样式1

图7不进行标注样式2


图8不进行标注样式3













参 考 文 献
[1]  基于人工智能的工业视觉检测平台通用技术规范
[2]  ×××××××××××××××××       
[3]  ×××××××××××××××××
[4]  ×××××××××××××××××


                               
 (粗实线1.5，版心宽度1/4长)
